<root main_tree_to_execute="MainTree">
    <BehaviorTree ID="MainTree">
        <Sequence name="collect hand tools">
            <SwitchControllerService
                name="switch to joint trajectory controlller"
                service_name="controller_manager/switch_controller"
                controller="scaled_pos_joint_traj_controller"
            />
            <Sequence name="detect AprilTags for tools and pallet">
                <SubTree
                    ID="detect pose"
                    name="detect pose of objects in the scene"
                    view_pose="0.13689;0.46118;1.0014;-0.21523;0.20459;0.6762;0.67422"
                    translational_offset="0;0;0"
                    object="tool_a"
                    object_pose="{tool_a_pose}"
                />
                <SubTree
                    ID="detect pose"
                    name="detect pose of objects in the scene"
                    view_pose="0.13689;0.46118;1.0014;-0.21523;0.20459;0.6762;0.67422"
                    translational_offset="0;0;0"
                    object="tool_c"
                    object_pose="{tool_c_pose}"
                />
                <SubTree
                    ID="detect pose"
                    name="detect pose of objects in the scene"
                    view_pose="0.13689;0.46118;1.0014;-0.21523;0.20459;0.6762;0.67422"
                    translational_offset="0;0;0"
                    object="tool_e"
                    object_pose="{tool_e_pose}"
                />
                <SubTree
                    ID="detect pose"
                    name="detect pose of objects in the scene"
                    view_pose="0.13689;0.46118;1.0014;-0.21523;0.20459;0.6762;0.67422"
                    translational_offset="0;0;0"
                    object="pallet_tool_slot_l"
                    object_pose="{pallet_tool_slot_l_pose}"
                />


                <SubTree
                    ID="detect pose"
                    name="detect pose of objects in the scene"
                    view_pose="0.13689;0.46118;1.0014;-0.21523;0.20459;0.6762;0.67422"
                    translational_offset="0;0;0"
                    object="pallet_tool_slot_r"
                    object_pose="{pallet_tool_slot_r_pose}"
                />


                <SubTree
                    ID="detect pose"
                    name="detect pose of objects in the scene"
                    view_pose="0.13689;0.46118;1.0014;-0.21523;0.20459;0.6762;0.67422"
                    translational_offset="0;0;0"
                    object="pallet_handle"
                    object_pose="{pallet_handle_pose}"
                />

            </Sequence>
            <Sequence name="pick and place phillips screwdriver">
                <SubTree
                    ID="pick tool"
                    name="pick the phillips screwdriver"
                    object="phillips screwdriver"
                    object_pose="{tool_a_pose}"
                    gripper_start_position="0.3"
                    gripper_end_position="0.8"
                    manip_offset_1="0;0;0.2;0;0;0"
                    manip_duration_1="10.0"
                    manip_offset_2="-0.15;0;0;0;0;0"
                    manip_duration_2="7.5"
                />

                <SubTree
                    ID="place tool"
                    object="phillips screwdriver"
                    pose="{pallet_tool_slot_l_pose}"
                />
            </Sequence>

            <Sequence name="pick and place nut driver">
                <SubTree
                    ID="pick tool"
                    name="pick nut driver"
                    object="nut driver"
                    object_pose="{tool_c_pose}"
                    gripper_start_position="0.3"
                    gripper_end_position="0.8"
                    manip_offset_1="0;0;0.2;0;0;0"
                    manip_duration_1="10.0"
                    manip_offset_2="-0.15;0;0;0;0;0"
                    manip_duration_2="7.5"
                />
                <SubTree
                    ID="place tool"
                    object="nut driver"
                    pose="{pallet_tool_slot_r_pose}"
                />
            </Sequence>

            <Sequence name="pick and place flathead screwdriver">
                <SubTree
                    ID="pick tool"
                    name="pick flathead screwdriver"
                    object="flathead screwdriver"
                    object_pose="{tool_e_pose}"
                    gripper_start_position="0.3"
                    gripper_end_position="0.8"
                    manip_offset_1="0;0;0.2;0;0;0"
                    manip_duration_1="10.0"
                    manip_offset_2="-0.15;0;0;0;0;0"
                    manip_duration_2="7.5"
                />
                <SubTree
                    ID="place tool"
                    object="flathead screwdriver"
                    pose="{pallet_tool_slot_r_pose}"
                />

            </Sequence>

        </Sequence>
    </BehaviorTree>
</root>