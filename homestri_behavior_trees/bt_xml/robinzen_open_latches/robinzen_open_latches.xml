<root main_tree_to_execute="MainTree">


    <BehaviorTree ID="MainTree">
        <Sequence>

            <AddCollisionMeshService
                service_name="apply_planning_scene"
                mesh_path="package://homestri_description/meshes/components/collision/robinzen_static_assembly.stl"
                pose="0.91;0;0.915;0;0;0"
                mesh_pose="0;0;0;0;0;0"
                id="robinzen_static_assembly"
                frame_id="world"
            />

            <AddCollisionMeshService
                service_name="apply_planning_scene"
                mesh_path="package://homestri_description/meshes/components/collision/robinzen_moving_assembly.stl"
                pose="0.91;0;0.915;0;0;0"
                mesh_pose="0;0;0;0;0;0"
                id="robinzen_moving_assembly"
                frame_id="world"
            />

            <AddCollisionMeshService
                service_name="apply_planning_scene"
                mesh_path="package://homestri_description/meshes/components/collision/robinzen_table.stl"
                pose="0.91;0;0.915;0;0;0"
                mesh_pose="0;0;0;0;0;0"
                id="robinzen_table"
                frame_id="world"
            />

            <SwitchControllerService
                service_name="controller_manager/switch_controller"
                controller="scaled_pos_joint_traj_controller"
            />

            <ManipulationAction
                server_name="manip_as"
                id="arm_pose"
                pose="0.5;0.078;1.23;0;0;0;1"
                translational_offset="0;0;0"
            />

            <DetectFrame
                source_frame="ru_latch_closed"
                target_frame="world"
                output_pose="{ru_latch_closed_pose}"
                timeout="3.0"
            />
            <DetectFrame
                source_frame="rl_latch_closed"
                target_frame="world"
                output_pose="{rl_latch_closed_pose}"
                timeout="3.0"
            />
            <DetectFrame
                source_frame="lu_latch_closed"
                target_frame="world"
                output_pose="{lu_latch_closed_pose}"
                timeout="3.0"
            />
            <DetectFrame
                source_frame="ll_latch_closed"
                target_frame="world"
                output_pose="{ll_latch_closed_pose}"
                timeout="3.0"
            />







            <SubTreePlus
                ID="OpenLatchSubtree"
                latch_pose="{ru_latch_closed_pose}"
            />











            <SwitchControllerService
                service_name="controller_manager/switch_controller"
                controller="forward_cartesian_traj_controller"
            />

            


            <!-- END -->



            <ManipulationAction
                server_name="manip_as"
                id="arm_pose"
                pose="{ru_latch_closed_pose}"
                translational_offset="-0.20;0;0"
            />
            <ManipulationAction
                server_name="manip_as"
                id="arm_pose"
                pose="{ru_latch_closed_pose}"
                translational_offset="-0.05;0;0"
            />
            <ManipulationAction
                server_name="manip_as"
                id="arm_pose"
                pose="{ru_latch_closed_pose}"
                translational_offset="-0.20;0;0"
            />
<!-- Right Lower Latch-->
            <ManipulationAction
                server_name="manip_as"
                id="arm_pose"
                pose="{rl_latch_closed_pose}"
                translational_offset="-0.20;0;0"
            />
            <ManipulationAction
                server_name="manip_as"
                id="arm_pose"
                pose="{rl_latch_closed_pose}"
                translational_offset="-0.05;0;0"
            />
            <ManipulationAction
                server_name="manip_as"
                id="arm_pose"
                pose="{rl_latch_closed_pose}"
                translational_offset="-0.20;0;0"
            />
<!-- Left Lower Latch -->
            <ManipulationAction
                server_name="manip_as"
                id="arm_pose"
                pose="{ll_latch_closed_pose}"
                translational_offset="-0.20;0;0"
            />
            <ManipulationAction
                server_name="manip_as"
                id="arm_pose"
                pose="{ll_latch_closed_pose}"
                translational_offset="-0.05;0;0"
            />
            <ManipulationAction
                server_name="manip_as"
                id="arm_pose"
                pose="{ll_latch_closed_pose}"
                translational_offset="-0.20;0;0"
            />
<!-- Left Upper Latch -->
            <ManipulationAction
                server_name="manip_as"
                id="arm_pose"
                pose="{lu_latch_closed_pose}"
                translational_offset="-0.20;0;0"
            />
            <ManipulationAction
                server_name="manip_as"
                id="arm_pose"
                pose="{lu_latch_closed_pose}"
                translational_offset="-0.05;0;0"
            />
            <ManipulationAction
                server_name="manip_as"
                id="arm_pose"
                pose="{lu_latch_closed_pose}"
                translational_offset="-0.20;0;0"
            />
            <!--
            <GripperAction
                server_name="gripper_controller/gripper_cmd"
                position="0"
                max_effort="20"
            />

            <SwitchControllerService
                service_name="controller_manager/switch_controller"
                controller="forward_cartesian_traj_controller"
            />


            <CartesianControlAction
                server_name="cartesian_control"
                offset="0.15;0;0;0;0;0"
                duration="8.0"
                frame_id="gripper_tip_link"
                mode="offset"
            />

            <TriggerService
                service_name="/ur_hardware_interface/zero_ftsensor"
            />

            <SwitchControllerService
                service_name="controller_manager/switch_controller"
                controller="cartesian_compliance_controller"
            />

            <GripperAction
                server_name="gripper_controller/gripper_cmd"
                position="0.8"
                max_effort="40"
            />

            <ComplianceControlAction
                server_name="compliance_control"
                offset="0;0;0.01;0;0;0"
                wrench="0;0;50;0;0;0"
                frame_id="world"
                mode="offset"
            />

 -->
        </Sequence>

    </BehaviorTree>

</root>