<root main_tree_to_execute="MainTree">


    <BehaviorTree ID="MainTree">
        <Sequence>

            <!-- <AddCollisionMeshService
                service_name="apply_planning_scene"
                mesh_path="package://homestri_description/meshes/components/collision/robinzen_static_assembly.stl"
                pose="0.91;0.14;0.915;0;0;0"
                mesh_pose="0;0;0;0;0;0"
                id="robinzen_static_assembly"
                frame_id="world"
            />

            <AddCollisionMeshService
                service_name="apply_planning_scene"
                mesh_path="package://homestri_description/meshes/components/collision/robinzen_moving_assembly.stl"
                pose="0.91;0.14;0.915;0;0;0"
                mesh_pose="0;0;0;0;0;0"
                id="robinzen_moving_assembly"
                frame_id="world"
            /> -->

            <AddCollisionMeshService
                service_name="apply_planning_scene"
                mesh_path="package://homestri_description/meshes/components/collision/robinzen_static_assembly.stl"
                pose="0.91;0;0.915;0;0;0"
                mesh_pose="0;0;0;0;0;0"
                id="robinzen_static_assembly"
                frame_id="world"
            />

            <AddCollisionMeshService
                service_name="apply_planning_scene"
                mesh_path="package://homestri_description/meshes/components/collision/robinzen_moving_assembly.stl"
                pose="0.91;0;0.915;0;0;0"
                mesh_pose="0;0;0;0;0;0"
                id="robinzen_moving_assembly"
                frame_id="world"
            />

            <AddCollisionMeshService
                service_name="apply_planning_scene"
                mesh_path="package://homestri_description/meshes/components/collision/robinzen_table.stl"
                pose="0.91;0;0.915;0;0;0"
                mesh_pose="0;0;0;0;0;0"
                id="robinzen_table"
                frame_id="world"
            />

            <SwitchControllerService
                service_name="controller_manager/switch_controller"
                controller="scaled_pos_joint_traj_controller"
            />

            <ManipulationAction
                server_name="manip_as"
                id="arm_pose"
                pose="0.5;0.078;1.4;0;0;0;1"
                translational_offset="0;0;0"
            />

            <DetectFrame
                source_frame="ru_latch_closed"
                target_frame="world"
                output_pose="{ru_latch_closed_pose}"
                timeout="3.0"
                t_x="0.875"
            />
            <DetectFrame
                source_frame="rl_latch_closed"
                target_frame="world"
                output_pose="{rl_latch_closed_pose}"
                timeout="3.0"
                t_x="0.875"
            />
            <DetectFrame
                source_frame="lu_latch_closed"
                target_frame="world"
                output_pose="{lu_latch_closed_pose}"
                timeout="3.0"
                t_x="0.885"
            />
            <DetectFrame
                source_frame="ll_latch_closed"
                target_frame="world"
                output_pose="{ll_latch_closed_pose}"
                timeout="3.0"
                t_x="0.885"
            />

            <!-- open -->


            <DetectFrame
                source_frame="ru_latch_open"
                target_frame="world"
                output_pose="{ru_latch_open_pose}"
                timeout="3.0"
                t_x="0.875"
            />
            <DetectFrame
                source_frame="rl_latch_open"
                target_frame="world"
                output_pose="{rl_latch_open_pose}"
                timeout="3.0"
                t_x="0.875"
            />
            <DetectFrame
                source_frame="lu_latch_open"
                target_frame="world"
                output_pose="{lu_latch_open_pose}"
                timeout="3.0"
                t_x="0.88"
            />
            <DetectFrame
                source_frame="ll_latch_open"
                target_frame="world"
                output_pose="{ll_latch_open_pose}"
                timeout="3.0"
                t_x="0.88"
            />




            <SubTreePlus
                ID="CloseLatchSubtree"
                latch_pose="{ru_latch_open_pose}"
            />

            <SubTreePlus
                ID="CloseLatchSubtree"
                latch_pose="{rl_latch_open_pose}"
            />


            <SwitchControllerService
                service_name="controller_manager/switch_controller"
                controller="scaled_pos_joint_traj_controller"
            />

            <ManipulationAction
                server_name="manip_as"
                id="arm_pose"
                pose="0.5;0.078;1.4;0;0;0;1"
                translational_offset="0;0;0"
            />




        </Sequence>

    </BehaviorTree>

</root>